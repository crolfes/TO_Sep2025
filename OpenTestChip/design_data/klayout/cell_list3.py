import klayout.db as db
# Load the layout
layout = db.Layout()
layout.read("T588_base_scanner.oas")  # Replace with your actual file path

# Recursive function to list cells up to a given depth
def list_cells(cell, depth, max_depth, indent=""):
    if depth > max_depth:
        return
    print(f"{indent}- {cell.name}")
    for inst in cell.each_inst():
        child = inst.cell
        if child:
            list_cells(child, depth + 1, max_depth, indent + "  ")

# List cells starting from each top cell
print("Listing cells down to 3 levels:")
for top_cell in layout.top_cells():
    print(f"\nTop cell: {top_cell.name}")
    list_cells(top_cell, depth=1, max_depth=5)
